{% extends 'base.html.twig' %}

{% block title %}{{ title }} - Duo Films{% endblock %}

{% block body %}
    <!-- Header da página de detalhes -->
    <header class="relative bg-[#121212] text-white py-20 overflow-hidden">
        <div class="absolute inset-0 z-0">
            <div class="bg-gradient-to-r from-black to-[#121212] opacity-70 absolute inset-0"></div>
            <img src="{{ asset('images/' ~ projeto.coverImage) }}" alt="{{ projeto.title }}"
                 class="w-full h-full object-cover opacity-50">
        </div>
        <div class="container mx-auto px-4 relative z-10">
            <nav class="flex mb-8 text-sm">
                <a href="{{ path('app_home') }}" class="text-gray-400 hover:text-white">Início</a>
                <span class="mx-2 text-gray-500">/</span>
                <a href="{{ path('app_portfolio') }}" class="text-gray-400 hover:text-white">Portfólio</a>
                <span class="mx-2 text-gray-500">/</span>
                <span class="text-white">{{ projeto.title }}</span>
            </nav>
            <div class="max-w-3xl">
                <span class="inline-block bg-white text-black text-sm font-medium px-3 py-1 rounded-full mb-4">{{ projeto.categoria }}</span>
                <h1 class="text-4xl md:text-5xl font-bold mb-4">{{ projeto.title }}</h1>
                <p class="text-xl text-gray-300">{{ projeto.description }}</p>
                <div class="flex flex-wrap gap-4 mt-6">
                    <div class="flex items-center text-gray-300">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        <span>{{ projeto.data }}</span>
                    </div>
                    <div class="flex items-center text-gray-300">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        <span>{{ projeto.local }}</span>
                    </div>
                    <div class="flex items-center text-gray-300">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        <span>{{ projeto.totalFotos }} fotos</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Tabs para navegar entre seções -->
    <div class="bg-black sticky top-16 z-20 shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex overflow-x-auto py-4 space-x-6 scrollbar-hide">
                <button class="tab-btn active text-white font-medium hover:text-gray-300 whitespace-nowrap px-2 py-1 border-b-2 border-white"
                        data-tab="photos">Fotografias
                </button>
                {% if projeto.videos|length > 0 %}
                    <button class="tab-btn text-gray-400 font-medium hover:text-white whitespace-nowrap px-2 py-1 border-b-2 border-transparent hover:border-white"
                            data-tab="videos">Vídeos
                    </button>
                {% endif %}
                <button class="tab-btn text-gray-400 font-medium hover:text-white whitespace-nowrap px-2 py-1 border-b-2 border-transparent hover:border-white"
                        data-tab="details">Detalhes do Projeto
                </button>
                <button class="tab-btn text-gray-400 font-medium hover:text-white whitespace-nowrap px-2 py-1 border-b-2 border-transparent hover:border-white"
                        data-tab="client">Cliente
                </button>
            </div>
        </div>
    </div>

    <!-- Conteúdo das tabs -->
    <div class="container mx-auto px-4 py-12">
        <!-- Tab de Fotografias -->
        <div class="tab-content active" id="photos">
            <!-- Filtros para fotos (opcional) -->
            <div class="flex justify-center mb-8">
                <div class="inline-flex space-x-2 bg-[#121212] p-1 rounded-lg">
                    <button class="photo-filter active px-4 py-2 rounded-lg bg-black text-white">Todas</button>
                    <button class="photo-filter px-4 py-2 rounded-lg text-gray-400 hover:text-white">Cerimônia</button>
                    <button class="photo-filter px-4 py-2 rounded-lg text-gray-400 hover:text-white">Recepção</button>
                    <button class="photo-filter px-4 py-2 rounded-lg text-gray-400 hover:text-white">Ensaio</button>
                </div>
            </div>

            <!-- Galeria de fotos em grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 photo-gallery">
                {% for foto in projeto.fotos %}
                    <div class="gallery-item relative overflow-hidden group rounded-lg"
                         data-category="{{ foto.categoria }}">
                        <img src="{{ asset('images/' ~ foto.url) }}" alt="{{ foto.alt }}"
                             class="w-full h-64 object-cover transition-transform duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-60 transition-all duration-300 flex items-center justify-center">
                            <div class="text-white opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0 flex space-x-2">
                                <button class="gallery-zoom bg-white text-black hover:bg-gray-200 rounded-full p-2"
                                        data-src="{{ asset('images/' ~ foto.url) }}">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Tab de Vídeos -->
        <div class="tab-content hidden" id="videos">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {% for video in projeto.videos %}
                    <div class="bg-[#121212] rounded-lg overflow-hidden shadow-lg">
                        <div class="aspect-w-16 aspect-h-9">
                            <iframe src="{{ video.url }}" frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                    allowfullscreen class="w-full h-full"></iframe>
                        </div>
                        <div class="p-4">
                            <h3 class="text-white font-bold text-lg mb-2">{{ video.title }}</h3>
                            <p class="text-gray-400">{{ video.description }}</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Tab de Detalhes do Projeto -->
        <div class="tab-content hidden" id="details">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <h2 class="text-2xl font-bold text-white mb-4">Sobre o Projeto</h2>
                    <div class="prose prose-lg prose-invert max-w-none">
                        <p class="text-white">{{ projeto.detailedDescription|raw }}</p>
                    </div>

                    <!-- Equipamento utilizado -->
                    <div class="mt-8">
                        <h3 class="text-xl font-bold text-white mb-4">Equipamento Utilizado</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                            {% for equipamento in projeto.equipamentos %}
                                <div class="bg-[#121212] p-4 rounded-lg">
                                    <div class="font-medium text-white">{{ equipamento.nome }}</div>
                                    <div class="text-sm text-gray-400">{{ equipamento.tipo }}</div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="lg:col-span-1">
                    <div class="bg-[#121212] p-6 rounded-lg sticky top-32">
                        <h3 class="text-xl font-bold text-white mb-4">Informações do Projeto</h3>
                        <div class="space-y-4">
                            <div>
                                <div class="text-sm text-gray-400 mb-1">Cliente</div>
                                <div class="font-medium text-white">{{ projeto.cliente }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-400 mb-1">Data</div>
                                <div class="font-medium text-white">{{ projeto.data }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-400 mb-1">Local</div>
                                <div class="font-medium text-white">{{ projeto.local }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-400 mb-1">Categoria</div>
                                <div class="font-medium text-white">{{ projeto.categoria }}</div>
                            </div>
                            <div>
                                <div class="text-sm text-gray-400 mb-1">Equipe</div>
                                <div class="font-medium text-white">{{ projeto.equipe|join(', ') }}</div>
                            </div>
                        </div>

                        <!-- Botão para CTA -->
                        <div class="mt-6">
                            <a href="{{ path('app_contact') }}"
                               class="block w-full bg-white text-black text-center font-medium py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors">
                                Solicitar Orçamento Similar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab de Cliente -->
        <div class="tab-content hidden" id="client">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <div>
                    <h2 class="text-2xl font-bold text-white mb-4">Sobre o Cliente</h2>
                    <div class="prose prose-lg prose-invert max-w-none">
                        <p class="text-white">{{ projeto.clienteInfo|raw }}</p>
                    </div>

                    <!-- Depoimento do cliente se disponível -->
                    {% if projeto.clienteDepoimento %}
                        <div class="mt-8 bg-[#121212] p-6 rounded-lg border-l-4 border-white">
                            <p class="text-white italic mb-4">{{ projeto.clienteDepoimento }}</p>
                            <div class="flex items-center">
                                {% if projeto.clienteAvatar %}
                                    <img src="{{ asset('images/' ~ projeto.clienteAvatar) }}"
                                         alt="{{ projeto.clienteNome }}"
                                         class="w-12 h-12 rounded-full mr-4 object-cover">
                                {% else %}
                                    <div class="w-12 h-12 bg-white text-black rounded-full flex items-center justify-center font-bold text-xl mr-4">
                                        {{ projeto.clienteNome|first }}
                                    </div>
                                {% endif %}
                                <div>
                                    <div class="font-medium text-white">{{ projeto.clienteNome }}</div>
                                    <div class="text-sm text-gray-400">{{ projeto.clienteCargo }}</div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>

                <div>
                    <!-- Mais projetos do mesmo cliente se disponível -->
                    {% if projeto.clienteOutrosProjetos|length > 0 %}
                        <h2 class="text-2xl font-bold text-white mb-4">Outros Projetos deste Cliente</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            {% for outroProjeto in projeto.clienteOutrosProjetos %}
                                <a href="{{ path('app_portfolio_details', {'slug': outroProjeto.slug}) }}"
                                   class="group">
                                    <div class="relative overflow-hidden rounded-lg">
                                        <img src="{{ asset('images/' ~ outroProjeto.coverImage) }}"
                                             alt="{{ outroProjeto.title }}"
                                             class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110">
                                        <div class="absolute inset-0 bg-black bg-opacity-30 group-hover:bg-opacity-50 transition-all duration-300"></div>
                                        <div class="absolute bottom-0 left-0 right-0 p-4">
                                            <h3 class="text-white font-bold">{{ outroProjeto.title }}</h3>
                                            <div class="text-sm text-gray-200">{{ outroProjeto.data }}</div>
                                        </div>
                                    </div>
                                </a>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="flex items-center justify-center h-full">
                            <div class="text-center bg-[#121212] p-8 rounded-lg">
                                <img src="{{ asset('images/client-logo.png') }}" alt="{{ projeto.cliente }}"
                                     class="h-32 mx-auto mb-4 object-contain">
                                <h3 class="text-xl font-bold text-white mb-2">Interessado em nossos serviços?</h3>
                                <p class="text-gray-300 mb-6">Podemos criar algo incrível para sua marca ou evento
                                    também.</p>
                                <a href="{{ path('app_contact') }}"
                                   class="inline-block bg-white text-black font-medium py-3 px-6 rounded-lg hover:bg-gray-200 transition-colors">
                                    Entrar em Contato
                                </a>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Galeria em modo fullscreen (modal) -->
    <div id="gallery-modal" class="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center hidden">
        <button id="close-modal" class="absolute top-4 right-4 text-white hover:text-gray-300 z-10">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <button id="prev-image" class="absolute left-4 text-white hover:text-gray-300 z-10">
            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
        </button>

        <button id="next-image" class="absolute right-4 text-white hover:text-gray-300 z-10">
            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </button>

        <div id="modal-content" class="max-w-7xl max-h-full p-4">
            <img id="modal-image" src="" alt="" class="max-w-full max-h-[85vh] mx-auto object-contain">
            <div class="text-white text-center mt-4">
                <div id="modal-caption" class="text-lg"></div>
                <div id="modal-counter" class="text-sm text-gray-400 mt-1"></div>
            </div>
        </div>
    </div>

    <!-- Projetos Relacionados -->
    <section class="py-16 bg-black">
        <div class="container mx-auto px-4">
            <h2 class="text-2xl font-bold text-white mb-8">Projetos Relacionados</h2>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for projetoRelacionado in projetosRelacionados %}
                    <a href="{{ path('app_portfolio_details', {'slug': projetoRelacionado.slug}) }}"
                       class="block group">
                        <div class="relative overflow-hidden rounded-lg">
                            <img src="{{ asset('images/' ~ projetoRelacionado.coverImage) }}"
                                 alt="{{ projetoRelacionado.title }}"
                                 class="w-full h-64 object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 bg-black bg-opacity-30 group-hover:bg-opacity-50 transition-all duration-300"></div>
                            <div class="absolute bottom-0 left-0 right-0 p-6">
                                <span class="inline-block bg-white text-black text-xs font-medium px-2 py-1 rounded-full mb-2">{{ projetoRelacionado.categoria }}</span>
                                <h3 class="text-white text-xl font-bold">{{ projetoRelacionado.title }}</h3>
                            </div>
                        </div>
                    </a>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Chamada para ação -->
    <section class="py-16 bg-[#121212] text-white text-center">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold mb-4">Gostou do que viu?</h2>
            <p class="text-xl text-gray-300 max-w-2xl mx-auto mb-8">
                Podemos criar algo igualmente incrível para o seu próximo evento ou projeto.
            </p>
            <a href="{{ path('app_contact') }}"
               class="inline-block bg-white text-black px-8 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                Solicitar Orçamento
            </a>
        </div>
    </section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('portfolio-details') }}
{% endblock %}